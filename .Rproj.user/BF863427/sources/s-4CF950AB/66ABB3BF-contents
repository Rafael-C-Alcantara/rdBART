#include "tree.h"
#include "treeProposal.h"
#include "utilities.h"
#include "metropolis.h"
#include "gibbs.h"

// [[Rcpp::export]]
Rcpp::List thetaDraw(Rcpp::List tree, const arma::mat& W, Rcpp::NumericMatrix X, const arma::vec& y, int m, double sigma)
{
  Rcpp::List out;
  Rcpp::NumericVector bn = bottomNodes(tree);
  Rcpp::List Lambda = lambdaPosterior(tree,W,X,m,sigma);
  Rcpp::List theta  = thetaPosterior(tree,W,X,y,Lambda,sigma);
  for (int i=0; i<theta.length(); i++)
    {
      out.push_back(mvrnormArma(1,theta[i],Lambda[i]),bn[i]);
    }
  return out;
}
